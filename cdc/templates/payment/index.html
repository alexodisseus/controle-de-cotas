{% extends "base.html" %}

{% block styles %}
    <!-- Bootstrap CSS -->
    {{ bootstrap.load_css() }}
    <link rel="stylesheet"
                  href="{{url_for('static', filename='index.css')}}">
{% endblock %}
{% block content %}







<div class="container mt-3">
  <h2>Relatório Bancário</h2>

  <div class="card mt-3 ">
    <div class="card-header d-flex justify-content-between align-items-center">
      Todos detalhes
      <div class="btn-group" role="group" aria-label="Ações">
            
            <button type="submit" class="btn btn-primary">Pagar</button>
            </a>
          </div>
    </div>

      <div class="table-responsive">
    
        <table id="tabela" class="table">
      <thead>
        <tr>
          <th scope="col">Ação</th>

          <th scope="col">Data</th>
          <th scope="col">Banco</th>
          <th scope="col">Agencia</th>
          <th scope="col">Conta</th>
          <th scope="col">Código</th>
          <th scope="col">Nome</th>
          <th scope="col">Quantidade</th>
          <th scope="col">Valor bruto</th>
          <th scope="col">Valor liquido</th>
          <th scope="col">Status</th>
        </tr>
      </thead>
      <tbody>
        {%if data:%}
        {%for x in data:%}
        {% set valor1 = x.ReportPayment.value | int %}
        {% set valor2 = x.ReportPayment.amount | int %}
        <tr>
          <td><input name="{{x.ReportPayment.id}}" type="checkbox"></td>
          
          <td>{{x.ReportPayment.date}}</td>
          <td>{{x[2].name_bank}}</td>
          <td>{{x[2].agency}}</td>
          <td>{{x[2].number_account }}</td>
          <td>
            <a href="{{url_for('shareholder.view', id=x[1].id )}}">
              
              {{x[1].code}}
            </a>
          </td>

          <td>{{x[1].name}}</td>
          <td>{{x[0].amount}}</td>
          <td>R$ {{valor1*valor2}}</td>
            {%if x.User.income_tax == "S":%}
            <td>R$ {{ tribute(valor1*valor2,dtribute)}}</td>
            {%else:%}
            <td>R$ {{valor1*valor2}}</td>

            {%endif%}
          <td>{{x[0].status}}</td>
        </tr>
        {%endfor%}
        {%endif%}
        <!-- Adicione mais linhas conforme necessário -->
      </tbody>
    </table>
  </div>

  </div>


  <!-- Adicione mais blocos de código para outros bancos, se necessário -->

</div>

{{ bootstrap.load_js() }}
<script type="text/javascript"></script>
<script>
  
// Defina uma variável para rastrear a página atual
let currentPage = 1;

// Função para carregar dados com AJAX


function loadData(){
    alert(1000)
    var xmlhttp=new XMLHttpRequest();
      document.getElementById('tabela').innerHTML = this.responseText;
 
    xmlhttp.open("GET","/pagamentos/ajax/", true);
    xmlhttp.send();
 
}
function () {
    // Faça uma requisição AJAX para obter os dados da página atual
    $.ajax({
        url: ``,
        method: 'GET',
        dataType: 'json',
        success: function (data) {

            alert('1')
            appendDataToTable(data);
            currentPage++;
        },
        error: function (error) {
            console.error('Erro ao :', error);
        }
    });
}

// Função para adicionar dados à tabela
function appendDataToTable(data) {
    const tbody = $('#tabela');

    data.forEach(item => {
        const row = $('<tr><td>asdasdasdasd</td></tr>');
        // Adicione os dados à linha da tabela conforme a estrutura da sua resposta JSON
        // Exemplo: row.append(`<td>${item.acao}</td>`);

        tbody.append(row);
    });
}

// Função para carregar mais dados quando o usuário rolar a página
$(window).scroll(function () {
    if ($(window).scrollTop() + $(window).height() == $(document).height()) {
        loadData();
    }
});

// Carregue os dados iniciais
loadData();
  alert(10)

</script>

{% endblock %}



<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabela com Filtro e Carregamento Dinâmico</title>
    <!-- Adicione os links para o Bootstrap e jQuery aqui -->
    <link rel="stylesheet" href="path/to/bootstrap.min.css">
    <script src="path/to/jquery.min.js"></script>
</head>
<body>
    <div class="container mt-3">
        <table id="tabela" class="table">
            <!-- Cabeçalho da tabela -->
            <thead>
                <tr>
                    <th>Ação</th>
                    <th>Data</th>
                    <th>Banco</th>
                    <th>Agência</th>
                    <th>Conta</th>
                    <th>Código</th>
                    <th>Nome</th>
                    <th>Quantidade</th>
                    <th>Valor bruto</th>
                    <th>Valor líquido</th>
                    <th>Status</th>
                </tr>
            </thead>
            <!-- Corpo da tabela -->
            <tbody>
                <!-- Os dados serão carregados dinamicamente aqui -->
            </tbody>
        </table>
    </div>

    <script src="seu-script.js"></script>
</body>
</html>




